(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    238481,       6451]
NotebookOptionsPosition[    231684,       6315]
NotebookOutlinePosition[    232092,       6333]
CellTagsIndexPosition[    232049,       6330]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Construct and reconstructing orbits from symbolic dynamics", "Title",
 CellChangeTimes->{{3.681234565888219*^9, 3.681234599646923*^9}, 
   3.681234630322983*^9, {3.809303462923086*^9, 
   3.8093034708938713`*^9}},ExpressionUUID->"49a9288c-acb7-4f41-ad60-\
8a96e511aef5"],

Cell[TextData[{
 "The goal of this notebook is to put in evidence the algebraic operations of \
the ",
 StyleBox["linear encoding of the cat map. ",
  FontWeight->"Bold"],
 "In the end we map between:\n- the discrete set of coordinates of the phase \
space ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"t", ",", "n"}]], TraditionalForm]],ExpressionUUID->
  "3e4a3291-6191-4270-80e1-fdfe0a5d6927"],
 " where t, n represent respectively the time and space evolution of the \
chaotic flow \n- ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", 
     RowBox[{"t", ",", "n"}]], " "}], TraditionalForm]],ExpressionUUID->
  "3de7a01f-e7e4-4b95-ab0f-182f1077e704"],
 "the symbolic encoding of the flow\nThe equation relating the two is given \
by ",
 StyleBox["Eq.(3) ",
  FontWeight->"Bold"],
 "of our research article found on the arXiv\n",
 ButtonBox["https://arxiv.org/pdf/1912.02940.pdf",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/pdf/1912.02940.pdf"], None},
  ButtonNote->"https://arxiv.org/pdf/1912.02940.pdf"],
 "\n\nIn particular, we look derive the finite matrix that maps from space of \
",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"t", ",", "n"}]], TraditionalForm]],ExpressionUUID->
  "d8dd3dd3-6522-4ae6-b413-bac89bb6d037"],
 " to space of symbols ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", 
    RowBox[{"t", ",", "n"}]], TraditionalForm]],ExpressionUUID->
  "d90bc6c2-2a6c-40f9-833e-cb09d60c27c4"],
 " called ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "d2518c17-a407-4b3d-aea5-ab56016d5447"]
}], "Text",
 CellChangeTimes->{{3.809303479077585*^9, 3.809303561497212*^9}, {
   3.809303626201882*^9, 3.809303732043494*^9}, {3.809303771941283*^9, 
   3.809304179475122*^9}, {3.8093042152370567`*^9, 3.809304217219795*^9}, {
   3.809304302679956*^9, 3.809304306590814*^9}, 3.809309564662677*^9, {
   3.809385856869678*^9, 
   3.809385881094136*^9}},ExpressionUUID->"5878c1c9-71ad-48e1-b4f7-\
10b292f0e12d"],

Cell[CellGroupData[{

Cell["Deriving m\[CloseCurlyQuote]s from x\[CloseCurlyQuote]s", "Chapter",
 CellFrame->{{0, 0}, {0, 3}},
 CellChangeTimes->{{3.681234606826995*^9, 3.681234622163166*^9}, {
  3.8093041890594587`*^9, 3.8093041892409763`*^9}, {3.8093049277744827`*^9, 
  3.809304928292569*^9}},ExpressionUUID->"4b878e77-7e58-444e-ba76-\
3ba2ab54e95c"],

Cell[TextData[{
 "Consider the system with periodicity in time ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "=", "5"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "cc8afe17-f5db-4305-9668-e39ab477f0a2"],
 " and periodicity in space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "p"], " ", "=", " ", "3"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b437f04d-0cc7-48c5-8002-2e7365b4c0e5"]
}], "Text",
 CellChangeTimes->{{3.809304248131115*^9, 3.8093042598585367`*^9}, {
  3.809304331885004*^9, 
  3.809304361661578*^9}},ExpressionUUID->"fd0a9c1e-bf68-4571-b77e-\
1726702a0ab0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"T", ",", "Np"}], "}"}], "=", " ", 
   RowBox[{"{", 
    RowBox[{"5", ",", " ", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"x", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", "Np"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"X", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.681234626520598*^9, 3.6812346508106213`*^9}, {
   3.681234745994232*^9, 3.6812348279048758`*^9}, {3.681234884889571*^9, 
   3.6812351739067297`*^9}, {3.681235217452142*^9, 3.681235611531129*^9}, {
   3.681235646530877*^9, 3.6812357161456423`*^9}, {3.681235755183432*^9, 
   3.6812358169632387`*^9}, {3.681235854890909*^9, 3.6812360365351677`*^9}, {
   3.681236088372262*^9, 3.6812363665181417`*^9}, {3.681236563268285*^9, 
   3.6812366034608107`*^9}, 3.6812367306479273`*^9, {3.681236766216181*^9, 
   3.6812368310186872`*^9}, {3.681236873386684*^9, 3.681236930085807*^9}, {
   3.681236963405045*^9, 3.681237027823886*^9}, {3.681237066173357*^9, 
   3.681237089863966*^9}, {3.681237507807797*^9, 3.681237508742566*^9}, {
   3.6812375927811604`*^9, 3.681237593378847*^9}, {3.681237629678203*^9, 
   3.681237680845312*^9}, {3.681237976641996*^9, 3.681237978566874*^9}, {
   3.681238321095955*^9, 3.681238339838307*^9}, {3.681238389340066*^9, 
   3.6812384031540823`*^9}, {3.6812390933415956`*^9, 
   3.6812391130660954`*^9}, {3.681239148823454*^9, 3.681239160429517*^9}, {
   3.6812392454607573`*^9, 3.681239245636401*^9}, {3.681239305486771*^9, 
   3.681239344197421*^9}, {3.681239392569457*^9, 3.6812396688678827`*^9}, {
   3.681239737769202*^9, 3.681239809583959*^9}, {3.681239995677124*^9, 
   3.6812400525546103`*^9}, {3.6812403532829742`*^9, 3.68124047115602*^9}, {
   3.68124052145848*^9, 3.681240592146592*^9}, {3.681398272731214*^9, 
   3.681398273580529*^9}, {3.681404796447338*^9, 3.681404802035687*^9}, {
   3.6814059603668213`*^9, 3.681406042579184*^9}, 3.681406091207781*^9, {
   3.6814238314828653`*^9, 3.681423832623486*^9}, {3.681434094337954*^9, 
   3.681434132423564*^9}, {3.681434194215465*^9, 3.68143420727043*^9}, {
   3.6814343757833633`*^9, 3.68143440768235*^9}, {3.681435262325716*^9, 
   3.681435264249263*^9}, {3.68143546468414*^9, 3.681435465417267*^9}, {
   3.681447656736291*^9, 3.68144766796898*^9}, {3.681448877210758*^9, 
   3.681448928726433*^9}, {3.681448965138453*^9, 3.681448971545157*^9}, {
   3.809304205843307*^9, 3.809304243404172*^9}, {3.8093043473726482`*^9, 
   3.80930437760848*^9}, {3.8093065387810917`*^9, 3.8093065607833967`*^9}, {
   3.8093088112073298`*^9, 3.809308817563512*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"6730aa9b-3c78-4bbf-b6f2-7e0380f31162"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["x", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["x", 
       RowBox[{"1", ",", "2"}]], 
      SubscriptBox["x", 
       RowBox[{"1", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"2", ",", "1"}]], 
      SubscriptBox["x", 
       RowBox[{"2", ",", "2"}]], 
      SubscriptBox["x", 
       RowBox[{"2", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"3", ",", "1"}]], 
      SubscriptBox["x", 
       RowBox[{"3", ",", "2"}]], 
      SubscriptBox["x", 
       RowBox[{"3", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"4", ",", "1"}]], 
      SubscriptBox["x", 
       RowBox[{"4", ",", "2"}]], 
      SubscriptBox["x", 
       RowBox[{"4", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"5", ",", "1"}]], 
      SubscriptBox["x", 
       RowBox[{"5", ",", "2"}]], 
      SubscriptBox["x", 
       RowBox[{"5", ",", "3"}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.809304234438826*^9, 3.8093043138463297`*^9, 3.80930437824535*^9, {
   3.809306559441119*^9, 3.809306561216391*^9}, {3.8093088135529203`*^9, 
   3.8093088329972878`*^9}},
 CellLabel->
  "Out[148]//MatrixForm=",ExpressionUUID->"ea830288-60e0-4e35-894f-\
e4c83601d42e"]
}, Open  ]],

Cell[TextData[{
 "Define the map A which maps from x\[CloseCurlyQuote]s to \
m\[CloseCurlyQuote]s\nFor that, we must derive the reformatted column vector \
of x called xbis, where all ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"t", ",", "n"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "91df7a4c-50fa-4785-a4ff-8dfde06d9227"],
 " are re-organized as a column vector"
}], "Text",
 CellChangeTimes->{{3.809306568379879*^9, 3.809306624423071*^9}, {
  3.8093083026987753`*^9, 
  3.8093083817605257`*^9}},ExpressionUUID->"82124bbe-2e30-475a-84ae-\
65c99e2d6549"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xbis", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"X", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Np", "*", "T"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Xbis", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.809308442556004*^9, 3.809308454145729*^9}, {
  3.809308807999238*^9, 3.809308836164711*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"715c16ca-fc54-4dd4-a64a-e49ade084915"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["x", 
       RowBox[{"1", ",", "1"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"1", ",", "2"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"1", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"2", ",", "1"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"2", ",", "2"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"2", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"3", ",", "1"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"3", ",", "2"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"3", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"4", ",", "1"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"4", ",", "2"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"4", ",", "3"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"5", ",", "1"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"5", ",", "2"}]]},
     {
      SubscriptBox["x", 
       RowBox[{"5", ",", "3"}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.809308454416027*^9, 3.809308836620821*^9},
 CellLabel->
  "Out[150]//MatrixForm=",ExpressionUUID->"4a2b0aae-749d-48b8-894d-\
51efd6040d15"]
}, Open  ]],

Cell["Then A is:", "Text",
 CellChangeTimes->{{3.809308462570754*^9, 3.8093084718900833`*^9}, {
  3.8093088428988333`*^9, 
  3.809308847870466*^9}},ExpressionUUID->"bba38554-37ad-4135-838d-\
6f6562d0d001"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Amap", "[", 
   RowBox[{"T", ",", "Np", ",", "s"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.809308474312119*^9, 3.809308487820776*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"72e60b68-a3e2-450d-820d-46a7cd49e58e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"s", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {
      RowBox[{"-", "1"}], "s", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "s", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"-", "1"}], "0", "0", "s", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "s", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "s", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "s", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "s", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "s", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "s", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "s", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "s", "0", "0", 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "s", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}]},
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "s", 
      RowBox[{"-", "1"}]},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "s"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.809308488260445*^9, 3.8093088497981367`*^9},
 CellLabel->
  "Out[151]//MatrixForm=",ExpressionUUID->"1b68a077-f248-4dc3-8cf2-\
18069c097ae4"]
}, Open  ]],

Cell[TextData[{
 "And the resulting mbis vector, which we need to reformat to actually get \
the symbols ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", 
    RowBox[{"t", ",", "n"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "8c9f03ce-3f47-4532-8eb7-2849cca5f043"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"mbis", " ", "=", " ", 
    RowBox[{"A", " ", "Xbis"}]}], TraditionalForm]],ExpressionUUID->
  "9434661a-7281-4194-b729-1a703b7eead3"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"mbis", " ", "\[Rule]", "m", " "}], TraditionalForm]],
  ExpressionUUID->"bfddb879-3cdd-4aa7-b044-1b493a026ab7"]
}], "Text",
 CellChangeTimes->{{3.809308493364217*^9, 3.80930853701285*^9}, {
  3.809308623274291*^9, 
  3.809308635625903*^9}},ExpressionUUID->"3ee78f25-2242-46ab-94e3-\
de4ca3587620"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mbis", " ", "=", " ", 
   RowBox[{
    RowBox[{"Amap", "[", 
     RowBox[{"T", ",", "Np", ",", "s"}], "]"}], ".", "Xbis"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mbis", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.809308546262928*^9, 3.809308560637247*^9}, 
   3.809308613866379*^9, {3.809308661982511*^9, 3.8093086708439703`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"72bdc16c-7743-4025-bbec-0c739be0c0c0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "1"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "2"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"4", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"4", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"4", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"5", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"5", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"5", ",", "3"}]]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.80930867113453*^9},
 CellLabel->
  "Out[131]//MatrixForm=",ExpressionUUID->"b3fdb9f5-d5c6-4e82-aec5-\
6b4f795f3feb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"mbis", ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", "Np"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"m", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.809308653244598*^9, 3.809308724168202*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"b5e03b2b-e772-44fa-8539-2c10ff86bf66"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"1", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "1"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "2"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"2", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"2", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"3", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "1"}]]}], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"4", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"4", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"3", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"4", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"5", ",", "1"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"5", ",", "2"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "3"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["x", 
         RowBox[{"1", ",", "3"}]]}], "-", 
       SubscriptBox["x", 
        RowBox[{"4", ",", "3"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "1"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"5", ",", "2"}]], "+", 
       RowBox[{"s", " ", 
        SubscriptBox["x", 
         RowBox[{"5", ",", "3"}]]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.809308658421623*^9, {3.80930871476121*^9, 3.809308724589631*^9}},
 CellLabel->
  "Out[135]//MatrixForm=",ExpressionUUID->"763d2984-b022-41e7-be38-\
ea99fbc0674c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining Functions", "Chapter",
 CellFrame->{{0, 0}, {0, 3}},
 CellChangeTimes->{{3.809308884136668*^9, 
  3.8093088923373003`*^9}},ExpressionUUID->"dcc891aa-6845-4b46-8963-\
e76876dd7db0"],

Cell[CellGroupData[{

Cell[TextData[{
 "Reconstruct orbits\n",
 StyleBox["Our goal is mostly to ", "Text"],
 StyleBox["reconstruct orbits", "Text",
  FontWeight->"Bold"],
 StyleBox[" in phase space from the symbolic dynamics. To that end, we follow \
the converse of the process written above:\n", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{"m", " ", "\[Rule]", " ", 
    RowBox[{"mbis", " ", "\[Rule]", " ", "xbis", " "}]}], TraditionalForm]], 
  "Text",
  FormatType->"TraditionalForm",ExpressionUUID->
  "b7b13f54-d8a6-4145-938d-df32c1e93bab"], "Text"],
 StyleBox[" using  xbis = ", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["A", 
     RowBox[{"-", "1"}]], " ", 
    RowBox[{"mbis", "."}]}], TraditionalForm]], "Text",
  FormatType->"TraditionalForm",ExpressionUUID->
  "554c6a18-8672-4515-8897-0d962c7dfa7a"], "Text"],
 StyleBox["  Then xbis ", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{"\[Rule]", " ", "x"}], TraditionalForm]], "Text",
  FormatType->"TraditionalForm",ExpressionUUID->
  "c2dbd01f-8204-4529-b206-db49c1002008"], "Text"]
}], "Subchapter",
 CellChangeTimes->{{3.809309080536805*^9, 3.809309088878565*^9}, {
  3.809309168444502*^9, 
  3.80930919540744*^9}},ExpressionUUID->"52d59c45-0ddf-489e-8510-\
9e9b5b9f60b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"floor", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "y", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "A", " ", "function", " ", "which", " ", "preserves", " ", "the", " ", 
       "mapping", " ", "of", " ", "the", " ", "chaotifc", " ", "flow", " ", 
       RowBox[{"between", " ", "[", 
        RowBox[{"0", ",", "1"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", ">=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", " ", "=", " ", 
          RowBox[{"x", " ", "-", " ", 
           RowBox[{"Floor", "[", "x", "]"}]}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", " ", "=", " ", 
          RowBox[{"x", " ", "+", " ", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"-", "x"}], "+", "1"}], "]"}]}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "y"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"Amap", "[", 
    RowBox[{"T_", ",", "Np_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"T", "*", "Np"}], ",", 
            RowBox[{"T", "*", "Np"}]}], "}"}]}], "]"}]}], ",", "t", ",", "n", 
       ",", "tbis"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "matrix", " ", "which", " ", "maps", " ", "from", " ", 
       "xbis", " ", "to", " ", "mbis"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"QR", " ", "=", " ", 
          RowBox[{"QuotientRemainder", "[", 
           RowBox[{"i", ",", "Np"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{
           RowBox[{"QR", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"QR", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "\[LessEqual]", " ", "t"}], "  ", "&&", " ", 
            RowBox[{"t", " ", "\[LessEqual]", " ", 
             RowBox[{"T", "-", "1"}]}], " ", "&&", " ", 
            RowBox[{"2", " ", "\[LessEqual]", " ", "n"}]}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t", "-", "2"}], ")"}], "*", "Np"}], " ", "+", " ",
                  "n"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t", "-", "1"}], ")"}], "*", "Np"}], " ", "+", " ",
                  "n", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t", "-", "1"}], ")"}], "*", "Np"}], " ", "+", " ",
                  "n"}]}], "]"}], "]"}], " ", "=", " ", "s"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t", "-", "1"}], ")"}], "*", "Np"}], " ", "+", " ",
                  "n", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"t", "*", "Np"}], " ", "+", " ", "n"}]}], "]"}], 
              "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"t", " ", "\[Equal]", "1"}], " ", "&&", " ", 
            RowBox[{"2", " ", "\[LessEqual]", " ", "n"}]}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"n", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "n"}], "]"}], "]"}], " ", "=", " ", "s"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", 
                RowBox[{"n", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"Np", " ", "+", " ", "n"}]}], "]"}], "]"}], " ", "=", 
             " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], " ", "+", " ",
                  "n"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"t", " ", "\[Equal]", " ", "T"}], " ", "&&", " ", 
            RowBox[{"2", " ", "\[LessEqual]", " ", "n"}]}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "n"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "2"}], ")"}], "*", "Np"}], "+", "n"}]}], 
               "]"}], "]"}], "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], " ", "+", " ",
                  "n", " ", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], " ", "+", " ",
                  "n"}]}], "]"}], "]"}], " ", "=", " ", "s"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], "+", "n", "+",
                  "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", "==", "1"}], " ", "&&", " ", 
            RowBox[{"2", "\[LessEqual]", "t"}], " ", "&&", " ", 
            RowBox[{"t", "\[LessEqual]", " ", 
             RowBox[{"T", "-", "1"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t", "-", "2"}], ")"}], "*", "Np"}], " ", "+", 
                 "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", " ", "s"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"t", "*", "Np"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"t", "*", "Np"}], "+", "1"}]}], "]"}], "]"}], " ", 
             "=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", " ", "==", " ", "0"}], " ", "&&", " ", 
            RowBox[{"3", "\[LessEqual]", "t"}], " ", "&&", " ", 
            RowBox[{"t", "\[LessEqual]", " ", "T"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tbis", " ", "=", " ", 
             RowBox[{"t", " ", "-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"tbis", " ", "-", "1"}], ")"}], "*", "Np"}]}], 
               "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"tbis", " ", "-", "1"}], ")"}], "*", "Np"}], "+", 
                 "1"}]}], "]"}], "]"}], "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"tbis", "*", "Np"}], "-", "1"}]}], "]"}], "]"}], " ",
              "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"tbis", "*", "Np"}]}], "]"}], "]"}], " ", "=", " ", 
             "s"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"tbis", "+", "1"}], ")"}], "*", "Np"}]}], "]"}], 
              "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", " ", "==", " ", "1"}], " ", "&&", " ", 
            RowBox[{"t", " ", "==", " ", "1"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "s"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "Np"}], "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"Np", "+", "1"}]}], "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], "+", "1"}]}], 
               "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
            RowBox[{"t", " ", "\[Equal]", " ", "T"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "2"}], ")"}], "*", "Np"}], "+", "1"}]}], 
               "]"}], "]"}], "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], "+", "1"}]}], 
               "]"}], "]"}], " ", "=", " ", "s"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], "+", "2"}]}], 
               "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"T", "*", "Np"}]}], "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
            RowBox[{"t", " ", "==", " ", "2"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "+=", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"Np", "-", "1"}]}], "]"}], "]"}], "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "Np"}], "]"}], "]"}], " ", "=", " ", "s"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"2", "*", "Np"}]}], "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"T", "*", "Np"}]}], "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", "\[Equal]", " ", "0"}], " ", "&&", " ", 
            RowBox[{"t", " ", "==", " ", 
             RowBox[{"T", "+", "1"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "Np"}], "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}]}], "]"}], "]"}],
              "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"T", "-", "1"}], ")"}], "*", "Np"}], "+", "1"}]}], 
               "]"}], "]"}], " ", "+=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"T", "*", "Np"}], "-", "1"}]}], "]"}], "]"}], " ", "+=",
              " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"T", "*", "Np"}]}], "]"}], "]"}], " ", "=", " ", 
             "s"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"T", "*", "Np"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "A"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Orbits", "[", 
   RowBox[{"s_", ",", "m_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "T", ",", "Np", ",", "A", ",", "mbis", ",", "Qbis", ",", "Q", ",", "P"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "A", " ", "function", " ", "to", " ", "map", " ", "from", " ", "the", 
      " ", "symbolic", " ", "dynamics", " ", "back", " ", "to", " ", "the", 
      " ", "phase", " ", "space", " ", "representation", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["q", "i"], ",", " ", 
        SubscriptBox["p", "i"]}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", "Np"}], "}"}], " ", "=", " ", 
      RowBox[{"Dimensions", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", " ", "=", " ", 
      RowBox[{"Amap", "[", 
       RowBox[{"T", ",", "Np", ",", "s"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mbis", " ", "=", " ", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"m", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Np", "*", "T"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Qbis", " ", "=", " ", 
      RowBox[{
       RowBox[{"Inverse", "[", "A", "]"}], ".", "mbis"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Q", " ", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"Qbis", ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "Np"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"P", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "Np"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"Q", "[", 
        RowBox[{"[", "T", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "T"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"floor", "[", 
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"floor", "[", 
          RowBox[{"P", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "T"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q", ",", "P"}], "}"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6846087652245483`*^9, 3.684608905213455*^9}, {
   3.6846090327365503`*^9, 3.684609174506776*^9}, 3.684609205036351*^9, {
   3.684609242374979*^9, 3.684609249681209*^9}, {3.6846093266054783`*^9, 
   3.684609328147216*^9}, 3.684609563190361*^9, {3.685729550147884*^9, 
   3.6857295509781*^9}, {3.685745016565794*^9, 3.685745018492434*^9}, {
   3.694466218115155*^9, 3.694466219328199*^9}, {3.8093091242364187`*^9, 
   3.809309137963153*^9}, {3.809309625786717*^9, 3.809309685416148*^9}, {
   3.8093859513579483`*^9, 
   3.8093860922542553`*^9}},ExpressionUUID->"d426140a-aeb9-4fb1-ae29-\
10b30a006b3e"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Generating different sequence of symbols\n",
 StyleBox["One key feature of this project is to see how symbolic dynamics ", 
  "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "tn"], " "}], TraditionalForm]], "Text",ExpressionUUID->
  "a8720a8b-0b03-4f82-a461-7e8805ab911f"], "Text"],
 StyleBox["that share common sequences produce trajectories in phase that \
overlap. The main example studied is the one of ", "Text"],
 StyleBox["figure 6 on the article", "Text",
  FontWeight->"Bold"],
 StyleBox[", where the core (blue region) of two symbolic dynamics shadow \
each other. We write multiple user-defined functions, each with a precise \
goal (generating \[LineSeparator]symbols, coloring of the matrices of symbols \
and plotting) in order to draw and plot the respective trajectories of these \
sequences, in phase space.", "Text"]
}], "Subchapter",
 CellChangeTimes->{{3.809309212926066*^9, 3.8093092198761683`*^9}, {
  3.8093093346196413`*^9, 3.8093095523200283`*^9}, {3.809386203306106*^9, 
  3.809386290583548*^9}, {3.809387860108142*^9, 
  3.80938791353417*^9}},ExpressionUUID->"97ac55a4-cdfb-4e87-98e8-\
27245df9e268"],

Cell[CellGroupData[{

Cell[TextData[{
 "Common core shared: diffoutside\n",
 StyleBox["Inputs two different matrices of symbols, a range of integers, the \
position and the size of the share block\nOutputs the two matrices with a \
shared rectangular-shaped sequence of symbols", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809309604145452*^9, 3.8093096090797033`*^9}, {
   3.809386103998556*^9, 3.809386110182432*^9}, {3.8093879461083193`*^9, 
   3.809387950535116*^9}, {3.809389383471751*^9, 3.809389401829132*^9}, 
   3.809389449765407*^9},ExpressionUUID->"3016f230-4a38-413c-b102-\
b80fd80299c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"diffoutside", "[", 
   RowBox[{
   "int_", ",", "m1_", ",", "m2_", ",", "pos_", ",", "tout_", ",", "nout_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l1", ",", "l2", ",", "mco"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l1", " ", "=", " ", "m1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"l2", " ", "=", " ", "m2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mco", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"tout", ",", "nout"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mco"}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mco"}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "l2"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.686864845244051*^9, 3.6868648798353043`*^9}, {
   3.6868649216003447`*^9, 3.686864972709649*^9}, {3.686865021113681*^9, 
   3.686865024662508*^9}, {3.686866989350873*^9, 3.686867104676162*^9}, {
   3.68686715432733*^9, 3.6868674007649918`*^9}, {3.686867965508109*^9, 
   3.686868008656342*^9}, 3.687209515779833*^9, 3.6872105147820683`*^9, 
   3.809309614949308*^9, {3.8093096991790047`*^9, 3.8093097008040447`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"5580f1ac-0cc5-4539-8f30-91e11c0a3c24"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Swapping 1 block of symbols: swapping1block\n",
 StyleBox["Inputs 1 matrix of symbols, a range of integers, the positions and \
the size of the swaps\nOutputs two identical matrices except for two \
rectangular-shaped sequences of symbols swapped", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809309867203412*^9, 3.809309868807353*^9}, {
  3.809309903887649*^9, 3.809309906964926*^9}, {3.8093880513860273`*^9, 
  3.80938805488142*^9}, {3.809389462903203*^9, 
  3.80938946445297*^9}},ExpressionUUID->"f4f1b661-cb5e-4a64-8317-\
9a19d6ba2374"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"swapping1block", "[", 
    RowBox[{
    "int_", ",", "m_", ",", "pos1_", ",", "pos2_", ",", "tout_", ",", 
     "nout_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", ",", "m2", ",", "mA", ",", "mB"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", " ", "=", " ", "m"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m2", " ", "=", " ", "m"}], ";", "\[IndentingNewLine]", 
      RowBox[{"mA", " ", "=", " ", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tout", ",", "nout"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mB", "=", " ", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tout", ",", "nout"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}], "=", " ", "mA"}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}], "=", " ", "mB"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}], "=", " ", "mB"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"m1", ",", "m2"}], "}"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809309910128974*^9, 3.809309934111289*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"e1ea6ed2-ed15-4b03-bfa4-c66ac4e3d4e5"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Swapping 2 blocks of symbols: swapping2blocks\n",
 StyleBox["Inputs 1 matrix of symbols, a range of integers, the positions and \
the size of the swaps and the positions of the bordering shared blocks\n\
Outputs two identical matrices except for two rectangular-shaped sequences of \
symbols swapped, surrounded by a shared thick border of symbols ", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.8093104031450357`*^9, 3.809310411271261*^9}, {
  3.809388188199725*^9, 3.8093881885598507`*^9}, {3.8093896667314663`*^9, 
  3.8093896722841187`*^9}},ExpressionUUID->"e00873a3-1f84-4a3d-82bf-\
0ae79dd31e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"swapping2blocks", " ", "[", 
   RowBox[{
   "int_", ",", "m_", ",", "pos1_", ",", "pos2_", ",", "posin_", ",", "tout_",
     ",", "nout_", ",", "tin_", ",", "nin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m1", "=", "m"}], ",", 
      RowBox[{"m2", "=", "m"}], ",", "\[IndentingNewLine]", 
      RowBox[{"mA", "=", " ", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tout", ",", "nout"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mB", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tin", ",", "nin"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mC", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tin", ",", "nin"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mB"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mC"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mC"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mB"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "m2"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809310414724772*^9, 3.809310477014657*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"db4cafca-cabd-441f-9ee9-3599dc6bff06"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Swapping 3 blocks symbols between 3 sequences: swapping3blocks\n",
 StyleBox["Does the same as swapping2blocks except the output is: three \
identical matrices with three rectangular-shaped sequences of symbols \
swapped, surrounded by a shared thick border of symbols", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809310597900816*^9, 3.809310612178734*^9}, {
  3.809310976541161*^9, 3.8093109863128633`*^9}, {3.809388393531527*^9, 
  3.809388397923931*^9}, {3.809388451321031*^9, 3.809388451498107*^9}, {
  3.809389691419964*^9, 
  3.809389691772395*^9}},ExpressionUUID->"196763d5-cf94-4cc6-9f05-\
4d51441ae74d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"swapping3blocks", "[", 
   RowBox[{
   "int_", ",", "m_", ",", "pos1_", ",", "pos2_", ",", "pos3_", ",", "posin_",
     ",", "tout_", ",", "nout_", ",", "tin_", ",", "nin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m1", "=", "m"}], ",", 
      RowBox[{"m2", "=", "m"}], ",", 
      RowBox[{"m3", "=", "m"}], ",", "\[IndentingNewLine]", 
      RowBox[{"mA", " ", "=", " ", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tout", ",", "nout"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"mB", "=", " ", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tin", ",", "nin"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mC", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tin", ",", "nin"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"mD", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tin", ",", "nin"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"pos3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"pos3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
        "]"}], "]"}], "=", " ", "mA"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mB"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mC"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mD"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mC"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mD"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mB"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mD"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mB"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";;", 
          RowBox[{
           RowBox[{"pos3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"posin", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}]}], "]"}],
        "]"}], "=", " ", "mC"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "m2", ",", "m3"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.686244402202899*^9, 3.686244594452416*^9}, {
  3.6862446466068974`*^9, 3.686244755357671*^9}, {3.686245076833762*^9, 
  3.686245078030686*^9}, {3.6862560882908983`*^9, 3.686256090281945*^9}, {
  3.686416198546267*^9, 3.686416203982543*^9}, {3.686602810306081*^9, 
  3.6866028228267107`*^9}, {3.6866048705246563`*^9, 3.6866048724135227`*^9}, {
  3.6866681229612293`*^9, 3.686668124047134*^9}, {3.809310511144923*^9, 
  3.8093105852930527`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"06352d3b-8a15-4397-9622-5595aba078ea"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Swapping 2 diamond-shaped blocks of symbols between 2 sequences: \
swapping2diamonds\n",
 StyleBox["Does the same as swapping2blocks except the shape of the swapped \
symbols and thick borders are diamond.", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809311011796432*^9, 3.809311038733096*^9}, {
  3.809388535823718*^9, 3.809388542709752*^9}, {3.809389726602549*^9, 
  3.80938972728154*^9}},ExpressionUUID->"f9f7ad1a-e5c9-48ae-88bb-\
ba5e20823f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"swapping2diamonds", "[", 
   RowBox[{
   "int_", ",", "m_", ",", "dout_", ",", "din_", ",", "pos1_", ",", "pos2_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "m1", ",", "m2", ",", "posb1", ",", "pint1", ",", "pinb1", ",", "posb2", 
      ",", "pint2", ",", "pinb2", ",", "Nto", ",", "Nbo", ",", "Nti", ",", 
      "Nbi", ",", "xto", ",", "xbo", ",", "yt1", ",", "yb1", ",", "yt2", ",", 
      "yb2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m1", " ", "=", " ", "m"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m2", " ", "=", " ", "m"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Nto", "=", 
      RowBox[{"dout", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Nbo", " ", "=", " ", 
      RowBox[{
       RowBox[{"dout", "^", "2"}], " ", "-", " ", 
       RowBox[{"2", "*", "dout"}], " ", "+", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Nti", "=", 
      RowBox[{"din", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Nbi", " ", "=", " ", 
      RowBox[{
       RowBox[{"din", "^", "2"}], " ", "-", " ", 
       RowBox[{"2", "*", "din"}], " ", "+", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xto", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nto"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xbo", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nbo"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"yt1", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nti"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yb1", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nbi"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yt2", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nti"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yb2", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nbi"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"posb1", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"2", "*", "dout"}], "-", "2"}], ",", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pint1", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "-", "din"}], ",", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pinb1", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "+", "din", "-", "2"}],
         ",", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"posb2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"2", "*", "dout"}], "-", "2"}], ",", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pint2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "-", "din"}], ",", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pinb2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "+", "din", "-", "2"}],
         ",", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "Outter", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dout"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dout", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "Inners", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "din"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"din", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "m2"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809311065934265*^9, 3.809311096565413*^9}, {
  3.809311137444479*^9, 3.809311139758381*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"01ad0355-91e9-4fbb-abb1-80df92155f3e"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Swapping 3 diamond-shaped cores between 3 sequences: swapping3diamonds\n",
 StyleBox["Does the same as swapping3blocks except the shape of the swapped \
symbols and thick borders are diamond.", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809311177557208*^9, 3.809311187732671*^9}, {
  3.809388584450059*^9, 3.809388589055749*^9}, {3.8093897410821667`*^9, 
  3.80938974184214*^9}},ExpressionUUID->"279528f5-fbee-40a7-9bef-\
aa14e151030f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"swapping3diamonds", "[", 
   RowBox[{
   "int_", ",", "m_", ",", "dout_", ",", "din_", ",", "pos1_", ",", "pos2_", 
    ",", "pos3_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m1", "=", "m"}], ",", 
      RowBox[{"m2", "=", "m"}], ",", 
      RowBox[{"m3", "=", "m"}], ",", "\[IndentingNewLine]", "Nto", ",", "Nbo",
       ",", "Nti", ",", "Nbi", ",", "xto", ",", "xbo", ",", "yt1", ",", "yt2",
       ",", "yt3", ",", "yb1", ",", "yb2", ",", "yb3", ",", 
      "\[IndentingNewLine]", "posb1", ",", "pint1", ",", "pinb1", ",", 
      "posb2", ",", "pint2", ",", "pinb2", ",", "posb3", ",", "pint3", ",", 
      "pinb3"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Nto", "=", 
      RowBox[{"dout", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Nbo", " ", "=", " ", 
      RowBox[{
       RowBox[{"dout", "^", "2"}], " ", "-", " ", 
       RowBox[{"2", "*", "dout"}], " ", "+", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Nti", "=", 
      RowBox[{"din", "^", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Nbi", " ", "=", " ", 
      RowBox[{
       RowBox[{"din", "^", "2"}], " ", "-", " ", 
       RowBox[{"2", "*", "din"}], " ", "+", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xto", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nto"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xbo", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nbo"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"yt1", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nti"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yb1", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nbi"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yt2", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nti"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yb2", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nbi"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yt3", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nti"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yb3", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "int"}], "}"}], ",", "Nbi"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"posb1", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"2", "*", "dout"}], "-", "2"}], ",", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pint1", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "-", "din"}], ",", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pinb1", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "+", "din", "-", "2"}],
         ",", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"posb2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"2", "*", "dout"}], "-", "2"}], ",", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pint2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "-", "din"}], ",", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pinb2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "+", "din", "-", "2"}],
         ",", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"posb3", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos3", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"2", "*", "dout"}], "-", "2"}], ",", 
        RowBox[{"pos3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pint3", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos3", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "-", "din"}], ",", 
        RowBox[{"pos3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pinb3", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos3", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "+", "din", "-", "2"}],
         ",", 
        RowBox[{"pos3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "Outter", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pos3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pos3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"xto", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dout"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"posb3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"posb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"posb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"xbo", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dout", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "Inners", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pint3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "i", "-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pint3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pint3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"yt2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "din"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"pinb3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"pinb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"pinb3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}]}], 
           "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yb2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "^", "2"}], "-", 
             RowBox[{"2", "*", "i"}], "+", "2"}], ";;", 
            RowBox[{"i", "^", "2"}]}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"din", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "m2", ",", "m3"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809311192467454*^9, 3.809311195631106*^9}, {
  3.809315702409092*^9, 3.8093157125120068`*^9}},
 CellLabel->
  "In[619]:=",ExpressionUUID->"1c0dead8-8b00-4150-b30c-2507eca1230b"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Coloring 1 block of symbols: coloring1block and coloring1blockwithfont\n",
 StyleBox["Inputs matrix of symbols and position and size of a block that \
needs to be colored\nOutputs same matrix with a block of colored symbols. The \
second function does the same with a special font for those same symbols.", 
  "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809311261114119*^9, 3.809311286723048*^9}, {
  3.8093113307490387`*^9, 3.80931133312435*^9}, {3.809388603904821*^9, 
  3.809388614399933*^9}, {3.809389758428214*^9, 
  3.809389759429305*^9}},ExpressionUUID->"1bec7a10-bd2f-4bde-a48f-\
806021e163cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"coloring1block", "[", 
    RowBox[{
    "m_", ",", "pos_", ",", "tout_", ",", "nout_", ",", "color_", ",", 
     "font_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mbis", " ", "=", " ", "m"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mbis", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontSize", "\[Rule]", "font"}], ",", "color", ",", 
              "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", "mbis"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coloring1blockwithfont", "[", 
   RowBox[{
   "m_", ",", "pos_", ",", "posin_", ",", "tout_", ",", "nout_", ",", "tin_", 
    ",", "nin_", ",", "color_", ",", "font1_", ",", "font2_"}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mbis", " ", "=", " ", "m"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mbis", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "font1"}], ",", "color", ",", 
             "Plain"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"pos", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"pos", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}], "}"}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mbis", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "font2"}], ",", "color", ",", 
             "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "mbis"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.80931388900916*^9, 3.809313920529953*^9}},
 CellLabel->
  "In[483]:=",ExpressionUUID->"728b028f-138a-4ca2-9715-09976a268555"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Coloring 1 inner and 1 outer blocks of symbols: coloring2blocks \n",
 StyleBox["Inputs matrix of symbols and position and size of a block and a \
thick border that need to be colored\nOutputs same matrix with colored \
symbols", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809311314964014*^9, 3.809311336629237*^9}, {
  3.8093887084753923`*^9, 3.809388711130245*^9}, {3.8093897736373377`*^9, 
  3.809389774275114*^9}},ExpressionUUID->"c5045663-f0a5-4128-853c-\
9e472c71b359"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coloring2blocks", " ", "[", 
   RowBox[{
   "m_", ",", "pos_", ",", "posin_", ",", "tout_", ",", "nout_", ",", "tin_", 
    ",", "nin_", ",", "color1_", ",", "color2_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mbis", " ", "=", " ", "m"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mbis", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "17"}], ",", "color1", ",", 
             "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"pos", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"pos", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}], "}"}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mbis", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "17"}], ",", "color2", ",", 
             "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "tin", "-", "1"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"posin", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "nin", "-", "1"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "mbis"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809311353600132*^9, 3.8093113571920233`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"69c02af0-f557-4752-af16-5ec0452167b5"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Coloring 1 inner and 1 outer diamond-shaped blocks of symbols: \
coloring2diamonds\n",
 StyleBox["Does the same as coloring2blocks, except for diamond-shaped blocks \
symbols rather than rectangular", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.8093114735566607`*^9, 3.8093114891465797`*^9}, {
  3.809388755765139*^9, 3.809388759390643*^9}, {3.809389787907741*^9, 
  3.8093897887563753`*^9}},ExpressionUUID->"530c2fde-d4b3-4dee-8c12-\
f6338157ed1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coloring2diamonds", "[", 
   RowBox[{
   "m_", ",", "dout_", ",", "din_", ",", "pos_", ",", "color1_", ",", 
    "color2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mbis", " ", "=", " ", "m"}], ",", "posb", ",", "pint", ",", 
      "pinb"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"posb", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"2", "*", "dout"}], "-", "2"}], ",", 
        RowBox[{"pos", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pint", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "-", "din"}], ",", 
        RowBox[{"pos", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pinb", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pos", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dout", "+", "din", "-", "2"}],
         ",", 
        RowBox[{"pos", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "Outer", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mbis", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "j"}], "]"}],
             "]"}], " ", "=", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"pos", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "j"}], 
               "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontSize", "\[Rule]", "17"}], ",", "color1", ",", 
               "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}], "}"}]}], 
        "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dout"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mbis", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "i"}], "+", 
               RowBox[{"posb", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", "j"}], "]"}],
             "]"}], " ", "=", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "i"}], "+", 
                 RowBox[{"posb", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", "j"}], 
               "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontSize", "\[Rule]", "17"}], ",", "color1", ",", 
               "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{
            RowBox[{"posb", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
           RowBox[{
            RowBox[{"posb", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}], "}"}]}], 
        "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dout", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "Inner", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mbis", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"pint", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "j"}], "]"}],
             "]"}], " ", "=", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"pint", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "j"}], 
               "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontSize", "\[Rule]", "17"}], ",", "color2", ",", 
               "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{
            RowBox[{"pint", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
           RowBox[{
            RowBox[{"pint", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}], "}"}]}], 
        "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "din"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mbis", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "i"}], "+", 
               RowBox[{"pinb", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", "j"}], "]"}],
             "]"}], " ", "=", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "i"}], "+", 
                 RowBox[{"pinb", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", "j"}], 
               "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontSize", "\[Rule]", "17"}], ",", "color2", ",", 
               "Bold"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{
            RowBox[{"pinb", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "i", "+", "1"}], ",", 
           RowBox[{
            RowBox[{"pinb", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "i", "-", "1"}]}], "}"}]}], 
        "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"din", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "mbis"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[651]:=",ExpressionUUID->"c2793ac8-8e4e-4c8c-8838-b3967dd75cbe"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Replacing symbols with color code: replacingsymbolswithsquares\n",
 StyleBox["Inputs a matrix of integers.\nOutputs a matrix of colors, where \
each color corresponds to an integer", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809311615568741*^9, 3.809311622679678*^9}, {
  3.809388834713538*^9, 3.8093888409619837`*^9}, {3.809389801064114*^9, 
  3.809389801709947*^9}},ExpressionUUID->"ddcb5a32-152a-4001-8e78-\
53ec6503338b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"replacingsymbolswithsquares", "[", 
   RowBox[{"m_", ",", "colors_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mcolored", ",", "mbis", ",", "ndiffnumbers", ",", "diffnumbers"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ndiffnumbers", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", "colors", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diffnumbers", " ", "=", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", "m", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"mbis", " ", "=", " ", "m"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mbis", " ", "=", " ", 
         RowBox[{"Replace", "[", 
          RowBox[{"mbis", ",", 
           RowBox[{
            RowBox[{"diffnumbers", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
            RowBox[{"colors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ndiffnumbers"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"mbis", ",", 
       RowBox[{"Mesh", "\[Rule]", "True"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[413]:=",ExpressionUUID->"1344c89c-c868-467e-8fd4-18d0ab30029e"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Drawing borders around color-coded symbols: drawingsquareborders\n",
 StyleBox["Inputs a matrix of colors and draws a rectangular contour around a \
region", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.8093116586649303`*^9, 3.8093116731125317`*^9}, {
  3.8093888501051073`*^9, 3.809388855791498*^9}, {3.809389817311059*^9, 
  3.809389818091477*^9}},ExpressionUUID->"a55820a4-8fd2-4752-a6ee-\
a562a5e54204"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"drawingsquareborders", "[", 
    RowBox[{"pos1_", ",", "pos2_", ",", "thickness_", ",", "color_"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rec", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rec", " ", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"{", 
            RowBox[{"color", ",", 
             RowBox[{"Thickness", "[", "thickness", "]"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"Opacity", "[", "0", "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{"pos1", ",", "pos2"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "rec"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drawingsquareborders", "[", 
    RowBox[{"pos1_", ",", "pos2_", ",", "thickness_"}], "]"}], ":=", 
   RowBox[{"drawingsquareborders", "[", 
    RowBox[{"pos1", ",", "pos2", ",", "thickness", ",", "Black"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809311767063033*^9, 3.809311835495451*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"bfb41041-8a5c-4bd7-a73a-d3a36908dfca"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Drawing diamond-shaped borders around color-coded symbols: \
drawingdiamondborders\n",
 StyleBox["Does the same drawingsquareborders except for diamond-shaped \
borders", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809311719275776*^9, 3.809311735514776*^9}, {
  3.809388910526178*^9, 3.809388914197687*^9}, {3.80938983280184*^9, 
  3.8093898333901377`*^9}},ExpressionUUID->"a1ac818f-8362-4298-b5e8-\
e5bcc071ee08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawingdiamondborders", "[", 
   RowBox[{"pos_", ",", "d_", ",", "thickness_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"diamond", "=", 
       RowBox[{"{", "}"}]}], ",", "diamondtl", ",", "diamondtr", ",", 
      "diamondbl", ",", "diamondbr", ",", "\[IndentingNewLine]", "postop", 
      ",", "posbottom", ",", "pointtl", ",", "pointtr", ",", "pointbl", ",", 
      "pointbr"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"diamondtl", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diamondtr", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"d", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diamondbl", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"d", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diamondbr", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"pointtl", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pointtr", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pointbl", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pointbr", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"postop", " ", "=", " ", "pos"}], ";", "\[IndentingNewLine]", 
     RowBox[{"posbottom", " ", "=", " ", 
      RowBox[{"pos", " ", "+", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", "d"}], "+", "1"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"pointtl", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"pointtl", ",", "\[IndentingNewLine]", 
           RowBox[{"postop", "-", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"m", "-", "1"}], ",", 
              RowBox[{"m", "-", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointbr", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"pointbr", ",", "\[IndentingNewLine]", 
           RowBox[{"posbottom", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"m", "-", "1"}], ",", 
              RowBox[{"m", "-", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"pointbl", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"pointbl", ",", "\[IndentingNewLine]", 
           RowBox[{"posbottom", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "m"}], ",", "m"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointtr", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"pointtr", ",", "\[IndentingNewLine]", 
           RowBox[{"postop", " ", "+", " ", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"-", "m"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
         ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"diamondtl", "[", 
          RowBox[{"[", "m", "]"}], "]"}], " ", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "thickness", "]"}], ",", " ", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"pointtl", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"pointtl", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"pointtl", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"diamondbr", "[", 
          RowBox[{"[", "m", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "thickness", "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"pointbr", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"pointbr", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"pointbr", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}], "}"}]}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "d"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"diamondbl", "[", 
          RowBox[{"[", "m", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "thickness", "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"pointbl", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"pointbl", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"pointbl", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"diamondtr", "[", 
          RowBox[{"[", "m", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "thickness", "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"pointtr", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"pointtr", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"pointtr", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}], "}"}]}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"diamond", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
       "diamondtl", ",", "diamondtr", ",", "diamondbl", ",", "diamondbr"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", "diamond", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809311844897812*^9, 3.809311865576356*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"8a7088df-2f34-42c5-a471-7e2ba0817007"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Plotting 2 sequences in (q, p) phase space with zoom-in: plotting2\n",
 StyleBox["Inputs two trajectories in phase space ", "Text",
  FontColor->GrayLevel[0]],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["q", "1"], ",", 
      SubscriptBox["p", "1"]}], ")"}], " ", "and", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["q", "2"], ",", " ", 
      SubscriptBox["p", "2"]}], ")"}]}], TraditionalForm]], "Text",
  FormatType->"TraditionalForm",
  FontColor->GrayLevel[0],ExpressionUUID->
  "6b16eb55-9f42-4664-a12e-adcec6b9573b"], "Text"],
 StyleBox["\nOutputs the discrete display of these trajectories in two \
separate plots: one ranging from [0, 1] (the entire phase space) and the \
other zoomed-in on a particular region of interest.\nThe two set of discrete \
points are plotted with green / red disks of different size in order to \
visualize how overlapping the trajectories are in phase space.", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.8093119376492558`*^9, 3.809311957933207*^9}, {
  3.8093119971165752`*^9, 3.809312003113574*^9}, {3.809388958946144*^9, 
  3.8093889612429867`*^9}, {3.809389853035203*^9, 
  3.809389853677966*^9}},ExpressionUUID->"c5af56fe-290e-4cfa-b3c5-\
8753fada4d8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotting2", "[", 
   RowBox[{
   "Q1_", ",", "P1_", ",", "Q2_", ",", "P2_", ",", "xplotrange_", ",", 
    "yplotrange_", ",", "dgreen_", ",", "dred_", ",", "sizeg1_", ",", 
    "sizeg2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Np", ",", "T", ",", "d", ",", "dmax", ",", "QP1", ",", "QP2", ",", 
      "diskgreen", ",", "diskred", ",", "rec", ",", "plotgraph", ",", "plot1",
       ",", "plot2"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", "Np"}], "}"}], " ", "=", " ", 
      RowBox[{"Dimensions", "[", "Q1", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QP1", "  ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "*", "Np"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QP2", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "*", "Np"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "Q1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "P1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "Q2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "P2", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"diskgreen", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Lighter", "[", "Green", "]"}], ",", 
         RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diskred", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Lighter", "[", "Red", "]"}], ",", 
         RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plotgraph", " ", "=", "  ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"QP1", ",", "QP2"}], "}"}], ",", " ", "\[IndentingNewLine]", 
        
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledSmallCircle]", ",", "sizeg1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledSmallCircle]", ",", "sizeg2"}], "}"}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Lighter", "[", "Green", "]"}], ",", 
           RowBox[{"Lighter", "[", "Red", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rec", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
          RowBox[{"Opacity", "[", "0", "]"}], ",", "Blue", ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xplotrange", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"yplotrange", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xplotrange", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"yplotrange", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "25"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot1", " ", "=", " ", 
      RowBox[{"Show", "[", 
       RowBox[{"rec", ",", "plotgraph"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plot2", " ", "=", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"QP1", ",", "QP2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"diskgreen", ",", "dgreen"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"diskred", ",", "dred"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"xplotrange", ",", "yplotrange"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "25"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"plot1", ",", "plot2"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8093122777748127`*^9, 3.8093122866509*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"05597d1f-1f8e-48c3-9b2a-7b895003aa3d"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Plotting 3 sequences in (q,p) phase space with zoom-in: plotting3\n",
 StyleBox["Inputs two trajectories in phase space ", "Text",
  FontColor->GrayLevel[0]],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["q", "1"], ",", 
      SubscriptBox["p", "1"]}], ")"}], ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["q", "2"], ",", " ", 
       SubscriptBox["p", "2"]}], ")"}], " ", "and", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["q", "3"], ",", " ", 
       SubscriptBox["p", "3"]}], ")"}], "  "}]}], TraditionalForm]], "Text",
  FormatType->"TraditionalForm",
  FontColor->GrayLevel[0],ExpressionUUID->
  "12a40449-c55a-4dc7-86de-37f8b3bf7504"], "Text"],
 StyleBox["\nDoes the same as plotting2 except with 3 sets of points and 3 \
different different disks of color green, red and blue.", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809312008178411*^9, 3.809312019842849*^9}, {
  3.809389225956695*^9, 3.809389227940649*^9}, {3.809389870737982*^9, 
  3.809389871401472*^9}},ExpressionUUID->"0528a618-e55b-4507-a872-\
29a9567ffa28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotting3", "[", 
   RowBox[{
   "Q1_", ",", "P1_", ",", "Q2_", ",", "P2_", ",", "Q3_", ",", "P3_", ",", 
    "xplotrange_", ",", "yplotrange_", ",", "dgreen_", ",", "dred_", ",", 
    "dblue_", ",", "sizeg1_", ",", "sizeg2_", ",", "sizeg3_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Np", ",", "T", ",", "QP1", ",", "QP2", ",", "QP3", ",", "rec", ",", 
      "plotgraph", ",", "diskgreen", ",", "diskred", ",", "diskblue", ",", 
      "plot1", ",", "plot2", ",", "plot3"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", "Np"}], "}"}], " ", "=", " ", 
      RowBox[{"Dimensions", "[", "Q1", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QP1", "  ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "*", "Np"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QP2", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "*", "Np"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QP3", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "*", "Np"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "Q1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "P1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "Q2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "P2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP3", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "Q3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"QP3", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Flatten", "[", "P3", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"diskgreen", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Lighter", "[", 
          RowBox[{"Green", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diskred", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Lighter", "[", 
          RowBox[{"Red", ",", "0.4"}], "]"}], ",", 
         RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diskblue", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Lighter", "[", 
          RowBox[{"Blue", ",", "0.2"}], "]"}], ",", 
         RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plotgraph", " ", "=", "  ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"QP1", ",", "QP2", ",", "QP3"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledSmallCircle]", ",", "sizeg1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledSmallCircle]", ",", "sizeg2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledSmallCircle]", ",", "sizeg3"}], "}"}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Lighter", "[", "Green", "]"}], ",", 
           RowBox[{"Lighter", "[", "Red", "]"}], ",", 
           RowBox[{"Lighter", "[", "Blue", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rec", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
          RowBox[{"Opacity", "[", "0", "]"}], ",", "Blue", ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xplotrange", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"yplotrange", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xplotrange", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"yplotrange", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "24"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot1", " ", "=", " ", 
      RowBox[{"Show", "[", 
       RowBox[{"rec", ",", "plotgraph"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"plot2", " ", "=", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"QP1", ",", "QP2", ",", "QP3"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"diskgreen", ",", "dgreen"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"diskred", ",", "dred"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"diskblue", ",", "dblue"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"xplotrange", ",", "yplotrange"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "24"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"plot1", ",", "plot2"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8093130484458933`*^9, 3.809313051739234*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"e22433bc-f639-4870-909a-539cd4342691"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Plotting 2 sequences in (q,p) phase space with zoom-in with special \
coloring for shared sequences of symbols: specialplotting2\n",
 StyleBox["Does the same as plotting2 except the coordinates ", "Text",
  FontColor->GrayLevel[0]],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["q", "tn"], ",", " ", 
      SubscriptBox["p", "tn"]}], ")"}], " "}], TraditionalForm]], "Text",
  FormatType->"TraditionalForm",
  FontColor->GrayLevel[0],ExpressionUUID->
  "b6b406f0-5a08-45da-978f-a968daf22967"], "Text"],
 StyleBox["corresponding to the symbolic dynamics that overshadow one another \
are plotted with a different coloring", "Text",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.809312110317834*^9, 3.809312144181548*^9}, {
  3.809389320244467*^9, 3.809389321325935*^9}, {3.8093898864477997`*^9, 
  3.809389887065237*^9}},ExpressionUUID->"186874f6-3a28-4c02-9905-\
38e497246336"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"qpinout", "[", 
    RowBox[{
    "Q1_", ",", "P1_", ",", "Q2_", ",", "P2_", ",", "pos_", ",", "tout_", ",",
      "nout_", ",", "tfac_", ",", "nfac_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Q1top", ",", "Q1left", ",", "Q1right", ",", "Q1bottom", ",", "P1top", 
       ",", "P1left", ",", "P1right", ",", "P1bottom", ",", "Q2top", ",", 
       "Q2left", ",", "Q2right", ",", "Q2bottom", ",", "P2top", ",", "P2left",
        ",", "P2right", ",", "P2bottom", ",", "\[IndentingNewLine]", "QP1out",
        ",", "QP2out", ",", "\[IndentingNewLine]", "Q1in", ",", "Q2in", ",", 
       "P1in", ",", "P2in", ",", "QP1in", ",", "QP2in"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "Outter", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Q1top", " ", "=", " ", 
       RowBox[{"Q1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q1left", " ", "=", " ", 
       RowBox[{"Q1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q1right", " ", "=", " ", 
       RowBox[{"Q1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q1bottom", " ", "=", " ", 
       RowBox[{"Q1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P1top", " ", "=", " ", 
       RowBox[{"P1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P1left", " ", "=", " ", 
       RowBox[{"P1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P1right", " ", "=", " ", 
       RowBox[{"P1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P1bottom", " ", "=", " ", 
       RowBox[{"P1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Q2top", " ", "=", " ", 
       RowBox[{"Q2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q2left", " ", "=", " ", 
       RowBox[{"Q2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q2right", " ", "=", " ", 
       RowBox[{"Q2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q2bottom", " ", "=", " ", 
       RowBox[{"Q2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P2top", " ", "=", " ", 
       RowBox[{"P2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P2left", " ", "=", " ", 
       RowBox[{"P2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P2right", " ", "=", " ", 
       RowBox[{"P2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P2bottom", " ", "=", " ", 
       RowBox[{"P2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tout", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nout", "-", "1"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"QP1out", "  ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "tout", "*", "nfac"}], "+", 
            RowBox[{"2", "tfac", "*", "nout"}], "-", 
            RowBox[{"4", "tfac", "*", "nfac"}]}], ",", "2"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"QP2out", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "tout", "*", "nfac"}], "+", 
            RowBox[{"2", "tfac", "*", "nout"}], "-", 
            RowBox[{"4", "tfac", "*", "nfac"}]}], ",", "2"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP1out", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "Q1top", "]"}], ",", 
         RowBox[{"Flatten", "[", "Q1left", "]"}], ",", 
         RowBox[{"Flatten", "[", "Q1right", "]"}], ",", 
         RowBox[{"Flatten", "[", "Q1bottom", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP1out", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "P1top", "]"}], ",", 
         RowBox[{"Flatten", "[", "P1left", "]"}], ",", 
         RowBox[{"Flatten", "[", "P1right", "]"}], ",", 
         RowBox[{"Flatten", "[", "P1bottom", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP2out", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "Q2top", "]"}], ",", 
         RowBox[{"Flatten", "[", "Q2left", "]"}], ",", 
         RowBox[{"Flatten", "[", "Q2right", "]"}], ",", 
         RowBox[{"Flatten", "[", "Q2bottom", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP2out", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "P2top", "]"}], ",", 
         RowBox[{"Flatten", "[", "P2left", "]"}], ",", 
         RowBox[{"Flatten", "[", "P2right", "]"}], ",", 
         RowBox[{"Flatten", "[", "P2bottom", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "Inner", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Q1in", " ", "=", " ", 
       RowBox[{"Q1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tfac", "+", "tout", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "nfac", "+", "nout", "-", 
            "1"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P1in", " ", "=", " ", 
       RowBox[{"P1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tfac", "+", "tout", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "nfac", "+", "nout", "-", 
            "1"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q2in", " ", "=", " ", 
       RowBox[{"Q2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tfac", "+", "tout", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "nfac", "+", "nout", "-", 
            "1"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P2in", " ", "=", " ", 
       RowBox[{"P2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "tfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "tfac", "+", "tout", "-", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "nfac"}], ";;", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "nfac", "+", "nout", "-", 
            "1"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"QP1in", "  ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"tout", "-", 
              RowBox[{"2", "tfac"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"nout", "-", 
              RowBox[{"2", "nfac"}]}], ")"}]}], ",", "2"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"QP2in", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"tout", "-", 
              RowBox[{"2", "tfac"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"nout", "-", 
              RowBox[{"2", "nfac"}]}], ")"}]}], ",", "2"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP1in", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Flatten", "[", "Q1in", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP1in", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Flatten", "[", "P1in", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP2in", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Flatten", "[", "Q2in", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QP2in", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Flatten", "[", "P2in", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"QP1in", ",", "QP2in", ",", "QP1out", ",", "QP2out"}], 
       "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"specialplotting2", "[", 
   RowBox[{
   "QP1in_", ",", "QP2in_", ",", "QP1out_", ",", "QP2out_", ",", "pos_", ",", 
    "tout_", ",", "nout_", ",", "tfac_", ",", "nfac_", ",", "xplotrange_", 
    ",", "yplotrange_", ",", "big1_", ",", "small1_", ",", "big2_", ",", 
    "small2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "d", ",", "dmax", ",", "rec", ",", "plotgraph", ",", "plot1", ",", 
      "plot2", ","}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotgraph", " ", "=", "  ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"QP1in", ",", "QP2in", ",", "QP1out", ",", "QP2out"}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "big1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "small1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledSquare]", ",", "big1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledSquare]", ",", "small1"}], "}"}]}], "}"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Lighter", "[", 
            RowBox[{"Green", ",", ".1"}], "]"}], ",", 
           RowBox[{"Lighter", "[", 
            RowBox[{"Red", ",", ".1"}], "]"}], ",", 
           RowBox[{"Lighter", "[", 
            RowBox[{"Blue", ",", ".5"}], "]"}], ",", 
           RowBox[{"Lighter", "[", 
            RowBox[{"Magenta", ",", ".3"}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"LineLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<{Q1,P1}inner\>\"", ",", "\"\<{Q2,P2}inner\>\"", ",", 
               "\"\<{Q1,P1}border\>\"", ",", "\"\<{Q2,P2}border\>\""}], "}"}],
              ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"10", ",", "10"}], "}"}], "}"}]}], ",", 
             RowBox[{"LegendFunction", "\[Rule]", "Frame"}], ",", 
             RowBox[{"Background", "\[Rule]", " ", "White"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{".80", ",", ".82"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.0", ",", "0.0"}], "}"}]}], "}"}]}], "]"}]}], "*)"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rec", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
          RowBox[{"Opacity", "[", "0", "]"}], ",", "Blue", ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xplotrange", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"yplotrange", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xplotrange", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"yplotrange", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "24"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot1", " ", "=", " ", 
      RowBox[{"Show", "[", 
       RowBox[{"rec", ",", "plotgraph", ",", 
        RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot2", " ", "=", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"QP1in", ",", "QP2in", ",", "QP1out", ",", "QP2out"}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "big2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "small2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledSquare]", ",", "big2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledSquare]", ",", "small2"}], "}"}]}], "}"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Lighter", "[", 
            RowBox[{"Green", ",", ".1"}], "]"}], ",", 
           RowBox[{"Lighter", "[", 
            RowBox[{"Red", ",", ".1"}], "]"}], ",", 
           RowBox[{"Lighter", "[", 
            RowBox[{"Blue", ",", ".5"}], "]"}], ",", 
           RowBox[{"Lighter", "[", 
            RowBox[{"Magenta", ",", "0.3"}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "800"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"xplotrange", ",", "yplotrange"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"PointLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<{Q1,P1}inner\>\"", ",", "\"\<{Q2,P2}inner\>\"", ",", 
                "\"\<{Q1,P1}border\>\"", ",", "\"\<{Q2,P2}border\>\""}], 
               "}"}], ",", 
              RowBox[{"LegendMarkerSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "10"}], "}"}], "}"}]}], ",", 
              RowBox[{"LegendFunction", "\[Rule]", "Frame"}], ",", 
              RowBox[{"Background", "\[Rule]", " ", "White"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{".80", ",", ".82"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.0", ",", "0.0"}], "}"}]}], "}"}]}], "]"}]}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "24"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"plot1", ",", "plot2"}], "}"}]}]}], "]"}]}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f6233357-20ca-4e30-9380-b91318940e08"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other functions", "Subsection",
 CellChangeTimes->{{3.809315418568386*^9, 
  3.809315421249084*^9}},ExpressionUUID->"05492a55-c1e0-44b7-8865-\
6191331b4852"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"assemble", "[", 
   RowBox[{"Q_", ",", "P_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n1", ",", "n2", ",", "QP"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"QP", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Dimensions", "[", "Q", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"QP", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "QP"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"distance", "[", "QP_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "QPdist"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2"}], "}"}], "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "QP", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"QPdist", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n1", ",", "n2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"QPdist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"Norm", "[", 
              RowBox[{"QP", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "QPdist"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"distancelog", "[", "QP_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "QPdist"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2"}], "}"}], "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "QP", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"QPdist", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n1", ",", "n2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"QPdist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"Log", "[", 
              RowBox[{"Norm", "[", 
               RowBox[{"QP", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}]}], ";"}],
            "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "QPdist"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avdistance", "[", "QP_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n1", ",", "n2", ",", "QPdists"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "QP", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"QPdists", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n1", ",", "n2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"QPdists", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"QP", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "^", "2"}]}], 
           ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Mean", "[", 
       RowBox[{"Flatten", "[", "QPdists", "]"}], "]"}], "//", "Sqrt"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.732564990026866*^9, 3.732565062985894*^9}, {
   3.732565231822096*^9, 3.7325652441576242`*^9}, 
   3.809315436396475*^9},ExpressionUUID->"83423737-f444-4e58-9314-\
0ba2e9c93c16"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1276, 749},
WindowMargins->{{Automatic, 0}, {-2, Automatic}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 276, 4, 98, "Title",ExpressionUUID->"49a9288c-acb7-4f41-ad60-8a96e511aef5"],
Cell[859, 28, 2018, 54, 179, "Text",ExpressionUUID->"5878c1c9-71ad-48e1-b4f7-10b292f0e12d"],
Cell[CellGroupData[{
Cell[2902, 86, 331, 5, 80, "Chapter",ExpressionUUID->"4b878e77-7e58-444e-ba76-3ba2ab54e95c"],
Cell[3236, 93, 648, 18, 38, "Text",ExpressionUUID->"fd0a9c1e-bf68-4571-b77e-1726702a0ab0"],
Cell[CellGroupData[{
Cell[3909, 115, 2871, 50, 73, "Input",ExpressionUUID->"6730aa9b-3c78-4bbf-b6f2-7e0380f31162"],
Cell[6783, 167, 1762, 57, 126, "Output",ExpressionUUID->"ea830288-60e0-4e35-894f-e4c83601d42e"]
}, Open  ]],
Cell[8560, 227, 606, 15, 60, "Text",ExpressionUUID->"82124bbe-2e30-475a-84ae-65c99e2d6549"],
Cell[CellGroupData[{
Cell[9191, 246, 493, 13, 52, "Input",ExpressionUUID->"715c16ca-fc54-4dd4-a64a-e49ade084915"],
Cell[9687, 261, 1702, 64, 326, "Output",ExpressionUUID->"4a2b0aae-749d-48b8-894d-51efd6040d15"]
}, Open  ]],
Cell[11404, 328, 205, 4, 35, "Text",ExpressionUUID->"bba38554-37ad-4135-838d-6f6562d0d001"],
Cell[CellGroupData[{
Cell[11634, 336, 274, 6, 30, "Input",ExpressionUUID->"72e60b68-a3e2-450d-820d-46a7cd49e58e"],
Cell[11911, 344, 3264, 94, 280, "Output",ExpressionUUID->"1b68a077-f248-4dc3-8cf2-18069c097ae4"]
}, Open  ]],
Cell[15190, 441, 819, 24, 75, "Text",ExpressionUUID->"3ee78f25-2242-46ab-94e3-de4ca3587620"],
Cell[CellGroupData[{
Cell[16034, 469, 478, 11, 52, "Input",ExpressionUUID->"72bdc16c-7743-4025-bbec-0c739be0c0c0"],
Cell[16515, 482, 6724, 228, 326, "Output",ExpressionUUID->"b3fdb9f5-d5c6-4e82-aec5-6b4f795f3feb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23276, 715, 413, 11, 52, "Input",ExpressionUUID->"b5e03b2b-e772-44fa-8539-2c10ff86bf66"],
Cell[23692, 728, 6703, 219, 126, "Output",ExpressionUUID->"763d2984-b022-41e7-be38-ea99fbc0674c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30444, 953, 195, 4, 80, "Chapter",ExpressionUUID->"dcc891aa-6845-4b46-8963-e76876dd7db0"],
Cell[CellGroupData[{
Cell[30664, 961, 1268, 33, 110, "Subchapter",ExpressionUUID->"52d59c45-0ddf-489e-8510-9e9b5b9f60b1"],
Cell[31935, 996, 23407, 587, 2210, "Input",ExpressionUUID->"d426140a-aeb9-4fb1-ae29-10b30a006b3e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[55379, 1588, 1175, 23, 117, "Subchapter",ExpressionUUID->"97ac55a4-cdfb-4e87-98e8-27245df9e268"],
Cell[CellGroupData[{
Cell[56579, 1615, 609, 11, 100, "Subsection",ExpressionUUID->"3016f230-4a38-413c-b102-b80fd80299c3"],
Cell[57191, 1628, 2567, 65, 173, "Input",ExpressionUUID->"5580f1ac-0cc5-4539-8f30-91e11c0a3c24",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[59795, 1698, 589, 11, 84, "Subsection",ExpressionUUID->"f4f1b661-cb5e-4a64-8317-9a19d6ba2374"],
Cell[60387, 1711, 3855, 105, 278, "Input",ExpressionUUID->"e1ea6ed2-ed15-4b03-bfa4-c66ac4e3d4e5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[64279, 1821, 650, 11, 84, "Subsection",ExpressionUUID->"e00873a3-1f84-4a3d-82bf-0ae79dd31e1e"],
Cell[64932, 1834, 7897, 220, 362, "Input",ExpressionUUID->"db4cafca-cabd-441f-9ee9-3599dc6bff06",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[72866, 2059, 662, 12, 84, "Subsection",ExpressionUUID->"196763d5-cf94-4cc6-9f05-4d51441ae74d"],
Cell[73531, 2073, 16606, 457, 635, "Input",ExpressionUUID->"06352d3b-8a15-4397-9622-5595aba078ea",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[90174, 2535, 498, 10, 61, "Subsection",ExpressionUUID->"f9f7ad1a-e5c9-48ae-88bb-ba5e20823f1f"],
Cell[90675, 2547, 19555, 528, 1391, "Input",ExpressionUUID->"01ad0355-91e9-4fbb-abb1-80df92155f3e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[110267, 3080, 486, 9, 61, "Subsection",ExpressionUUID->"279528f5-fbee-40a7-9bef-aa14e151030f"],
Cell[110756, 3091, 37965, 1032, 2084, "Input",ExpressionUUID->"1c0dead8-8b00-4150-b30c-2507eca1230b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[148758, 4128, 651, 12, 84, "Subsection",ExpressionUUID->"1bec7a10-bd2f-4bde-a48f-806021e163cf"],
Cell[149412, 4142, 4886, 135, 362, "Input",ExpressionUUID->"728b028f-138a-4ca2-9715-09976a268555",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[154335, 4282, 524, 10, 84, "Subsection",ExpressionUUID->"c5045663-f0a5-4128-853c-9e472c71b359"],
Cell[154862, 4294, 3287, 90, 236, "Input",ExpressionUUID->"69c02af0-f557-4752-af16-5ec0452167b5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[158186, 4389, 498, 10, 61, "Subsection",ExpressionUUID->"530c2fde-d4b3-4dee-8c12-f6338157ed1e"],
Cell[158687, 4401, 7702, 209, 698, "Input",ExpressionUUID->"c2793ac8-8e4e-4c8c-8838-b3967dd75cbe",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[166426, 4615, 476, 9, 84, "Subsection",ExpressionUUID->"ddcb5a32-152a-4001-8e78-53ec6503338b"],
Cell[166905, 4626, 1695, 42, 236, "Input",ExpressionUUID->"1344c89c-c868-467e-8fd4-18d0ab30029e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[168637, 4673, 455, 9, 61, "Subsection",ExpressionUUID->"a55820a4-8fd2-4752-a6ee-a562a5e54204"],
Cell[169095, 4684, 1282, 34, 131, "Input",ExpressionUUID->"bfb41041-8a5c-4bd7-a73a-d3a36908dfca",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[170414, 4723, 463, 10, 61, "Subsection",ExpressionUUID->"a1ac818f-8362-4298-b5e8-e5bcc071ee08"],
Cell[170880, 4735, 8296, 203, 992, "Input",ExpressionUUID->"8a7088df-2f34-42c5-a471-7e2ba0817007",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[179213, 4943, 1313, 29, 107, "Subsection",ExpressionUUID->"c5af56fe-290e-4cfa-b3c5-8753fada4d8c"],
Cell[180529, 4974, 6682, 169, 740, "Input",ExpressionUUID->"05597d1f-1f8e-48c3-9b2a-7b895003aa3d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[187248, 5148, 1178, 30, 84, "Subsection",ExpressionUUID->"0528a618-e55b-4507-a872-29a9567ffa28"],
Cell[188429, 5180, 8053, 203, 845, "Input",ExpressionUUID->"e22433bc-f639-4870-909a-539cd4342691",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[196519, 5388, 969, 22, 61, "Subsection",ExpressionUUID->"186874f6-3a28-4c02-9905-38e497246336"],
Cell[197491, 5412, 27490, 704, 1790, "Input",ExpressionUUID->"f6233357-20ca-4e30-9380-b91318940e08",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[225018, 6121, 163, 3, 38, "Subsection",ExpressionUUID->"05492a55-c1e0-44b7-8865-6191331b4852"],
Cell[225184, 6126, 6448, 183, 808, "Input",ExpressionUUID->"83423737-f444-4e58-9314-0ba2e9c93c16"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

